var Ie=Object.defineProperty,Le=Object.defineProperties;var Ce=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var ue=(r,i,s)=>i in r?Ie(r,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[i]=s,M=(r,i)=>{for(var s in i||(i={}))ze.call(i,s)&&ue(r,s,i[s]);if(ce)for(var s of ce(i))Ee.call(i,s)&&ue(r,s,i[s]);return r},K=(r,i)=>Le(r,Ce(i));import{aq as Y,Y as fe,Z as ne,$ as ve,e as me,ch as de,ci as Se,cj as Oe,a9 as pe,x as ge,c5 as xe,f as v,ck as Ne,y,bm as we,H as le,ap as ye,an as he,o as h,h as oe,b as c,w,a as m,A as u,aZ as t,a7 as _e,C as O,n as S,b0 as Te,c as _,aS as $e,a6 as Ae,F as re,cl as Ve,b1 as Be,B as De,cm as Me,cn as Ye,D as Re,aN as Fe,aQ as Xe,S as ie,K as G,bg as He,bX as Pe,z as be,co as se,as as A,cp as V,a2 as ke,cq as je,cr as Ze,t as We,L as qe,cs as Ke,bs as Ge,ct as Qe,cu as Je,cv as Ue}from"./index.727d535c.js";const et=()=>Y&&/firefox/i.test(window.navigator.userAgent),tt=fe({urlList:{type:ne(Array),default:()=>ve([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),at={close:()=>!0,switch:r=>typeof r=="number"},st=["src"],nt={name:"ElImageViewer"},lt=me(K(M({},nt),{props:tt,emits:at,setup(r,{emit:i}){const s=r,C={CONTAIN:{name:"contain",icon:de(Se)},ORIGINAL:{name:"original",icon:de(Oe)}},Q=et()?"DOMMouseScroll":"mousewheel",{t:x}=pe(),o=ge("image-viewer"),{nextZIndex:J}=xe(),b=v(),z=v([]),R=Ne(),E=v(!0),d=v(s.initialIndex),k=v(C.CONTAIN),l=v({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),F=y(()=>{const{urlList:e}=s;return e.length<=1}),T=y(()=>d.value===0),X=y(()=>d.value===s.urlList.length-1),U=y(()=>s.urlList[d.value]),B=y(()=>{const{scale:e,deg:a,offsetX:n,offsetY:f,enableTransition:I}=l.value;let p=n/e,L=f/e;switch(a%360){case 90:case-270:[p,L]=[L,-p];break;case 180:case-180:[p,L]=[-p,-L];break;case 270:case-90:[p,L]=[-L,p];break}const $={transform:`scale(${e}) rotate(${a}deg) translate(${p}px, ${L}px)`,transition:I?"transform .3s":""};return k.value.name===C.CONTAIN.name&&($.maxWidth=$.maxHeight="100%"),$}),ee=y(()=>we(s.zIndex)?s.zIndex:J());function N(){ae(),i("close")}function te(){const e=se(n=>{switch(n.code){case A.esc:s.closeOnPressEscape&&N();break;case A.space:Z();break;case A.left:W();break;case A.up:g("zoomIn");break;case A.right:q();break;case A.down:g("zoomOut");break}}),a=se(n=>{(n.wheelDelta?n.wheelDelta:-n.detail)>0?g("zoomIn",{zoomRate:1.2,enableTransition:!1}):g("zoomOut",{zoomRate:1.2,enableTransition:!1})});R.run(()=>{V(document,"keydown",e),V(document,Q,a)})}function ae(){R.stop()}function H(){E.value=!1}function P(e){E.value=!1,e.target.alt=x("el.image.error")}function j(e){if(E.value||e.button!==0||!b.value)return;l.value.enableTransition=!1;const{offsetX:a,offsetY:n}=l.value,f=e.pageX,I=e.pageY,p=se($=>{l.value=K(M({},l.value),{offsetX:a+$.pageX-f,offsetY:n+$.pageY-I})}),L=V(document,"mousemove",p);V(document,"mouseup",()=>{L()}),e.preventDefault()}function D(){l.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Z(){if(E.value)return;const e=Object.keys(C),a=Object.values(C),n=k.value.name,I=(a.findIndex(p=>p.name===n)+1)%e.length;k.value=C[e[I]],D()}function W(){if(T.value&&!s.infinite)return;const e=s.urlList.length;d.value=(d.value-1+e)%e}function q(){if(X.value&&!s.infinite)return;const e=s.urlList.length;d.value=(d.value+1)%e}function g(e,a={}){if(E.value)return;const{zoomRate:n,rotateDeg:f,enableTransition:I}=M({zoomRate:1.4,rotateDeg:90,enableTransition:!0},a);switch(e){case"zoomOut":l.value.scale>.2&&(l.value.scale=Number.parseFloat((l.value.scale/n).toFixed(3)));break;case"zoomIn":l.value.scale<7&&(l.value.scale=Number.parseFloat((l.value.scale*n).toFixed(3)));break;case"clockwise":l.value.deg+=f;break;case"anticlockwise":l.value.deg-=f;break}l.value.enableTransition=I}return le(U,()=>{ye(()=>{const e=z.value[0];e!=null&&e.complete||(E.value=!0)})}),le(d,e=>{D(),i("switch",e)}),he(()=>{var e,a;te(),(a=(e=b.value)==null?void 0:e.focus)==null||a.call(e)}),(e,a)=>(h(),oe(Pe,{to:"body",disabled:!e.teleported},[c(He,{name:"viewer-fade",appear:""},{default:w(()=>[m("div",{ref_key:"wrapper",ref:b,tabindex:-1,class:u(t(o).e("wrapper")),style:ie({zIndex:t(ee)})},[m("div",{class:u(t(o).e("mask")),onClick:a[0]||(a[0]=_e(n=>e.hideOnClickModal&&N(),["self"]))},null,2),O(" CLOSE "),m("span",{class:u([t(o).e("btn"),t(o).e("close")]),onClick:N},[c(t(S),null,{default:w(()=>[c(t(Te))]),_:1})],2),O(" ARROW "),t(F)?O("v-if",!0):(h(),_(re,{key:0},[m("span",{class:u([t(o).e("btn"),t(o).e("prev"),t(o).is("disabled",!e.infinite&&t(T))]),onClick:W},[c(t(S),null,{default:w(()=>[c(t($e))]),_:1})],2),m("span",{class:u([t(o).e("btn"),t(o).e("next"),t(o).is("disabled",!e.infinite&&t(X))]),onClick:q},[c(t(S),null,{default:w(()=>[c(t(Ae))]),_:1})],2)],64)),O(" ACTIONS "),m("div",{class:u([t(o).e("btn"),t(o).e("actions")])},[m("div",{class:u(t(o).e("actions__inner"))},[c(t(S),{onClick:a[1]||(a[1]=n=>g("zoomOut"))},{default:w(()=>[c(t(Ve))]),_:1}),c(t(S),{onClick:a[2]||(a[2]=n=>g("zoomIn"))},{default:w(()=>[c(t(Be))]),_:1}),m("i",{class:u(t(o).e("actions__divider"))},null,2),c(t(S),{onClick:Z},{default:w(()=>[(h(),oe(De(k.value.icon)))]),_:1}),m("i",{class:u(t(o).e("actions__divider"))},null,2),c(t(S),{onClick:a[3]||(a[3]=n=>g("anticlockwise"))},{default:w(()=>[c(t(Me))]),_:1}),c(t(S),{onClick:a[4]||(a[4]=n=>g("clockwise"))},{default:w(()=>[c(t(Ye))]),_:1})],2)],2),O(" CANVAS "),m("div",{class:u(t(o).e("canvas"))},[(h(!0),_(re,null,Re(e.urlList,(n,f)=>Fe((h(),_("img",{ref_for:!0,ref:I=>z.value[f]=I,key:n,src:n,style:ie(t(B)),class:u(t(o).e("img")),onLoad:H,onError:P,onMousedown:j},null,46,st)),[[Xe,f===d.value]])),128))],2),G(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}}));var ot=be(lt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const rt=ke(ot),it=fe({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},lazy:{type:Boolean,default:!1},scrollContainer:{type:ne([String,Object])},previewSrcList:{type:ne(Array),default:()=>ve([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0}}),ct={error:r=>r instanceof Event,switch:r=>we(r),close:()=>!0},ut=["src"],dt={key:0},ft={name:"ElImage",inheritAttrs:!1},vt=me(K(M({},ft),{props:it,emits:ct,setup(r,{emit:i}){const s=r;let C="";const{t:Q}=pe(),x=ge("image"),o=je(),J=Ze(),b=v(!1),z=v(!0),R=v(0),E=v(0),d=v(!1),k=v(),l=v();let F,T;const X=y(()=>o.style),U=y(()=>{const{fit:e}=s;return Y&&e?{objectFit:e}:{}}),B=y(()=>{const{previewSrcList:e}=s;return Array.isArray(e)&&e.length>0}),ee=y(()=>{const{previewSrcList:e,initialIndex:a}=s;let n=a;return a>e.length-1&&(n=0),n}),N=()=>{if(!Y)return;z.value=!0,b.value=!1;const e=new Image,a=s.src;e.addEventListener("load",n=>{a===s.src&&te(n,e)}),e.addEventListener("error",n=>{a===s.src&&ae(n)}),Object.entries(o).forEach(([n,f])=>{n.toLowerCase()!=="onload"&&e.setAttribute(n,f)}),e.src=a};function te(e,a){R.value=a.width,E.value=a.height,z.value=!1,b.value=!1}function ae(e){z.value=!1,b.value=!0,i("error",e)}function H(){Je(k.value,l.value)&&(N(),D())}const P=Ue(H,200);async function j(){var e;if(!Y)return;await ye();const{scrollContainer:a}=s;Ke(a)?l.value=a:Ge(a)&&a!==""?l.value=(e=document.querySelector(a))!=null?e:void 0:k.value&&(l.value=Qe(k.value)),l.value&&(F=V(l,"scroll",P),setTimeout(()=>H(),100))}function D(){!Y||!l.value||!P||(F(),l.value=void 0)}function Z(e){if(!!e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function W(){!B.value||(T=V("wheel",Z,{passive:!1}),C=document.body.style.overflow,document.body.style.overflow="hidden",d.value=!0)}function q(){T==null||T(),document.body.style.overflow=C,d.value=!1,i("close")}function g(e){i("switch",e)}return le(()=>s.src,()=>{s.lazy?(z.value=!0,b.value=!1,D(),j()):N()}),he(()=>{s.lazy?j():N()}),(e,a)=>(h(),_("div",{ref_key:"container",ref:k,class:u([t(x).b(),e.$attrs.class]),style:ie(t(X))},[z.value?G(e.$slots,"placeholder",{key:0},()=>[m("div",{class:u(t(x).e("placeholder"))},null,2)]):b.value?G(e.$slots,"error",{key:1},()=>[m("div",{class:u(t(x).e("error"))},We(t(Q)("el.image.error")),3)]):(h(),_("img",qe({key:2},t(J),{src:e.src,style:t(U),class:[t(x).e("inner"),t(B)?t(x).e("preview"):""],onClick:W}),null,16,ut)),t(B)?(h(),_(re,{key:3},[d.value?(h(),oe(t(rt),{key:0,"z-index":e.zIndex,"initial-index":t(ee),infinite:e.infinite,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:q,onSwitch:g},{default:w(()=>[e.$slots.viewer?(h(),_("div",dt,[G(e.$slots,"viewer")])):O("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):O("v-if",!0)],2112)):O("v-if",!0)],6))}}));var mt=be(vt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const wt=ke(mt);export{wt as E};
